{"platform":{"name":"ubuntu","release":"20.04","target_id":"bdf4338d-8fb0-5ca6-a949-ced198781ad5"},"profiles":[{"name":"linux-security-checks","version":"0.1.0","sha256":"13e0c276ec19f696a1586c1dca8a7034763c973aa040c473fa3c6b281b7a32c3","title":"InSpec Profile","maintainer":"Jesse C.","summary":"An InSpec Compliance Profile","license":"Apache-2.0","copyright":"Jesse C. & MITRE Team","copyright_email":"jesse.crim@frit.frb.org","supports":[{"platform":"os"}],"attributes":[],"groups":[{"id":"controls/linux_checks.rb","controls":["os-info-check","sudoers-check","logging-check","password-policy-check","suid-sgid-check"],"title":"Linux System Security Checks"},{"id":"controls/rootkit_access_check.rb","controls":["rootkit-access-check"]}],"controls":[{"id":"os-info-check","title":"Operating System Information Check","desc":"Verify operating system information including version and build details","descriptions":[{"label":"default","data":"Verify operating system information including version and build details"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'os-info-check' do\n  impact 1.0\n  title 'Operating System Information Check'\n  desc 'Verify operating system information including version and build details'\n\n  describe os.name do\n    it { should_not be_empty }\n  end\n\n  describe os.release do\n    it { should_not be_empty }\n  end\n\n  describe os.family do\n    it { should_not be_empty }\n  end\n\n  describe command('uname -a') do\n    its('stdout') { should_not be_empty }\n  end\nend\n","source_location":{"line":6,"ref":"linux-security-checks/controls/linux_checks.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"ubuntu is expected not to be empty","run_time":0.00978291,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"Object","resource_params":"[]","resource_id":"ubuntu"},{"status":"passed","code_desc":"20.04 is expected not to be empty","run_time":0.003317205,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"Object","resource_params":"[]","resource_id":"20.04"},{"status":"passed","code_desc":"debian is expected not to be empty","run_time":0.003265579,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"Object","resource_params":"[]","resource_id":"debian"},{"status":"passed","code_desc":"Command: `uname -a` stdout is expected not to be empty","run_time":0.029592373,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"command","resource_params":"[\"uname -a\"]","resource_id":"Command: `uname -a`"}]},{"id":"sudoers-check","title":"Sudoers Configuration Check","desc":"Verify that sudoers configuration exists and is properly configured","descriptions":[{"label":"default","data":"Verify that sudoers configuration exists and is properly configured"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'sudoers-check' do\n  impact 1.0\n  title 'Sudoers Configuration Check'\n  desc 'Verify that sudoers configuration exists and is properly configured'\n\n  describe file('/etc/sudoers') do\n    it { should exist }\n    it { should be_file }\n  end\n\n  describe.one do\n    describe command('grep -E \"^[^#].*ALL=.*ALL\" /etc/sudoers') do\n      its('exit_status') { should eq 0 }\n    end\n\n    describe command('grep -E \"^[^#].*ALL=.*ALL\" /etc/sudoers.d/*') do\n      its('exit_status') { should eq 0 }\n    end\n  end\n\n  describe group('sudo') do\n    it { should exist }\n  end\nend\n","source_location":{"line":29,"ref":"linux-security-checks/controls/linux_checks.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /etc/sudoers is expected to exist","run_time":0.000170648,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/etc/sudoers\"]","resource_id":"/etc/sudoers"},{"status":"passed","code_desc":"File /etc/sudoers is expected to be file","run_time":0.010329199,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/etc/sudoers\"]","resource_id":"/etc/sudoers"},{"status":"failed","code_desc":"Command: `grep -E \"^[^#].*ALL=.*ALL\" /etc/sudoers` exit_status is expected to eq 0","run_time":0.00021982,"start_time":"2024-12-05T16:37:50+00:00","message":"\nexpected: 0\n     got: 2\n\n(compared using ==)\n","exception":"RSpec::Core::MultipleExceptionError","resource_class":"command","resource_params":"[\"grep -E \\\"^[^#].*ALL=.*ALL\\\" /etc/sudoers\"]","resource_id":"Command: `grep -E \"^[^#].*ALL=.*ALL\" /etc/sudoers`"},{"status":"failed","code_desc":"Command: `grep -E \"^[^#].*ALL=.*ALL\" /etc/sudoers.d/*` exit_status is expected to eq 0","run_time":0.000113862,"start_time":"2024-12-05T16:37:50+00:00","message":"\nexpected: 0\n     got: 2\n\n(compared using ==)\n","exception":"RSpec::Core::MultipleExceptionError","resource_class":"command","resource_params":"[\"grep -E \\\"^[^#].*ALL=.*ALL\\\" /etc/sudoers.d/*\"]","resource_id":"Command: `grep -E \"^[^#].*ALL=.*ALL\" /etc/sudoers.d/*`"},{"status":"passed","code_desc":"Group sudo is expected to exist","run_time":0.001259338,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"group","resource_params":"[\"sudo\"]","resource_id":"sudo-27"}]},{"id":"logging-check","title":"System Logging Check","desc":"Verify that system logging is enabled and configured","descriptions":[{"label":"default","data":"Verify that system logging is enabled and configured"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'logging-check' do\n  impact 1.0\n  title 'System Logging Check'\n  desc 'Verify that system logging is enabled and configured'\n\n  describe.one do\n    describe service('rsyslog') do\n      it { should be_enabled }\n      it { should be_running }\n    end\n    \n    describe service('syslog-ng') do\n      it { should be_enabled }\n      it { should be_running }\n    end\n  end\n\n  # Check for any of the common log files\n  describe.one do\n    describe file('/var/log/syslog') do\n      it { should exist }\n      it { should be_file }\n    end\n\n    describe file('/var/log/messages') do\n      it { should exist }\n      it { should be_file }\n    end\n\n    describe file('/var/log/journal') do\n      it { should exist }\n      it { should be_directory }\n    end\n  end\n\n  if command('systemctl').exist?\n    describe service('systemd-journald') do\n      it { should be_enabled }\n      it { should be_running }\n    end\n  end\nend\n","source_location":{"line":55,"ref":"linux-security-checks/controls/linux_checks.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Service rsyslog is expected to be enabled","run_time":0.000126797,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"service","resource_params":"[\"rsyslog\"]","resource_id":"rsyslog"},{"status":"passed","code_desc":"Service rsyslog is expected to be running","run_time":7.9438e-05,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"service","resource_params":"[\"rsyslog\"]","resource_id":"rsyslog"},{"status":"passed","code_desc":"Service syslog-ng is expected to be enabled","run_time":7.6532e-05,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"service","resource_params":"[\"syslog-ng\"]","resource_id":"syslog-ng"},{"status":"passed","code_desc":"Service syslog-ng is expected to be running","run_time":0.000100337,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"service","resource_params":"[\"syslog-ng\"]","resource_id":"syslog-ng"},{"status":"passed","code_desc":"File /var/log/journal is expected to exist","run_time":7.9328e-05,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/var/log/journal\"]","resource_id":"/var/log/journal"},{"status":"passed","code_desc":"File /var/log/journal is expected to be directory","run_time":0.000100437,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/var/log/journal\"]","resource_id":"/var/log/journal"},{"status":"passed","code_desc":"Service systemd-journald is expected to be enabled","run_time":0.04716514,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"service","resource_params":"[\"systemd-journald\"]","resource_id":"systemd-journald"},{"status":"passed","code_desc":"Service systemd-journald is expected to be running","run_time":0.000940694,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"service","resource_params":"[\"systemd-journald\"]","resource_id":"systemd-journald"}]},{"id":"password-policy-check","title":"Password Policy Check","desc":"Verify password length and complexity requirements","descriptions":[{"label":"default","data":"Verify password length and complexity requirements"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'password-policy-check' do\n  impact 1.0\n  title 'Password Policy Check'\n  desc 'Verify password length and complexity requirements'\n\n  describe.one do\n    describe command('grep -E \"^[^#].*pam_pwquality.so.*minlen=(8|9|[1-9][0-9]+)\" /etc/pam.d/common-password') do\n      its('exit_status') { should eq 0 }\n    end\n\n    describe command('grep -E \"^[^#].*pam_unix.so.*minlen=(8|9|[1-9][0-9]+)\" /etc/pam.d/common-password') do\n      its('exit_status') { should eq 0 }\n    end\n\n    describe file('/etc/security/pwquality.conf') do\n      its('content') { should match /^[\\s]*minlen[\\s]*=[\\s]*([89]|[1-9][0-9]+)/ }\n    end\n\n    describe file('/etc/login.defs') do\n      its('content') { should match /^[\\s]*PASS_MIN_LEN[\\s]+([89]|[1-9][0-9]+)/ }\n    end\n  end\nend\n","source_location":{"line":99,"ref":"linux-security-checks/controls/linux_checks.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"Command: `grep -E \"^[^#].*pam_pwquality.so.*minlen=(8|9|[1-9][0-9]+)\" /etc/pam.d/common-password` exit_status is expected to eq 0","run_time":0.000148928,"start_time":"2024-12-05T16:37:50+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","exception":"RSpec::Core::MultipleExceptionError","resource_class":"command","resource_params":"[\"grep -E \\\"^[^#].*pam_pwquality.so.*minlen=(8|9|[1-9][0-9]+)\\\" /etc/pam.d/common-password\"]","resource_id":"Command: `grep -E \"^[^#].*pam_pwquality.so.*minlen=(8|9|[1-9][0-9]+)\" /etc/pam.d/common-password`"},{"status":"failed","code_desc":"Command: `grep -E \"^[^#].*pam_unix.so.*minlen=(8|9|[1-9][0-9]+)\" /etc/pam.d/common-password` exit_status is expected to eq 0","run_time":0.000107841,"start_time":"2024-12-05T16:37:50+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","exception":"RSpec::Core::MultipleExceptionError","resource_class":"command","resource_params":"[\"grep -E \\\"^[^#].*pam_unix.so.*minlen=(8|9|[1-9][0-9]+)\\\" /etc/pam.d/common-password\"]","resource_id":"Command: `grep -E \"^[^#].*pam_unix.so.*minlen=(8|9|[1-9][0-9]+)\" /etc/pam.d/common-password`"},{"status":"failed","code_desc":"File /etc/security/pwquality.conf content is expected to match /^[\\s]*minlen[\\s]*=[\\s]*([89]|[1-9][0-9]+)/","run_time":0.000174064,"start_time":"2024-12-05T16:37:50+00:00","message":"expected nil to match /^[\\s]*minlen[\\s]*=[\\s]*([89]|[1-9][0-9]+)/","exception":"RSpec::Core::MultipleExceptionError","resource_class":"file","resource_params":"[\"/etc/security/pwquality.conf\"]","resource_id":"/etc/security/pwquality.conf"},{"status":"failed","code_desc":"File /etc/login.defs content is expected to match /^[\\s]*PASS_MIN_LEN[\\s]+([89]|[1-9][0-9]+)/","run_time":0.003481842,"start_time":"2024-12-05T16:37:50+00:00","message":"expected \"#\\n# /etc/login.defs - Configuration control definitions for the login package.\\n#\\n# Three items mu...###################\\n\\n# CLOSE_SESSIONS\\n# LOGIN_STRING\\n# NO_PASSWORD_CONSOLE\\n# QMAIL_DIR\\n\\n\\n\\n\" to match /^[\\s]*PASS_MIN_LEN[\\s]+([89]|[1-9][0-9]+)/\nDiff:\n@@ -1,338 +1,675 @@\n-/^[\\s]*PASS_MIN_LEN[\\s]+([89]|[1-9][0-9]+)/\n+#\n+# /etc/login.defs - Configuration control definitions for the login package.\n+#\n+# Three items must be defined:  MAIL_DIR, ENV_SUPATH, and ENV_PATH.\n+# If unspecified, some arbitrary (and possibly incorrect) value will\n+# be assumed.  All other items are optional - if not specified then\n+# the described action or option will be inhibited.\n+#\n+# Comment lines (lines beginning with \"#\") and blank lines are ignored.\n+#\n+# Modified for Linux.  --marekm\n+\n+# REQUIRED for useradd/userdel/usermod\n+#   Directory where mailboxes reside, _or_ name of file, relative to the\n+#   home directory.  If you _do_ define MAIL_DIR and MAIL_FILE,\n+#   MAIL_DIR takes precedence.\n+#\n+#   Essentially:\n+#      - MAIL_DIR defines the location of users mail spool files\n+#        (for mbox use) by appending the username to MAIL_DIR as defined\n+#        below.\n+#      - MAIL_FILE defines the location of the users mail spool files as the\n+#        fully-qualified filename obtained by prepending the user home\n+#        directory before $MAIL_FILE\n+#\n+# NOTE: This is no more used for setting up users MAIL environment variable\n+#       which is, starting from shadow 4.0.12-1 in Debian, entirely the\n+#       job of the pam_mail PAM modules\n+#       See default PAM configuration files provided for\n+#       login, su, etc.\n+#\n+# This is a temporary situation: setting these variables will soon\n+# move to /etc/default/useradd and the variables will then be\n+# no more supported\n+MAIL_DIR        /var/mail\n+#MAIL_FILE      .mail\n+\n+#\n+# Enable logging and display of /var/log/faillog login failure info.\n+# This option conflicts with the pam_tally PAM module.\n+#\n+FAILLOG_ENAB\t\tyes\n+\n+#\n+# Enable display of unknown usernames when login failures are recorded.\n+#\n+# WARNING: Unknown usernames may become world readable. \n+# See #290803 and #298773 for details about how this could become a security\n+# concern\n+LOG_UNKFAIL_ENAB\tno\n+\n+#\n+# Enable logging of successful logins\n+#\n+LOG_OK_LOGINS\t\tno\n+\n+#\n+# Enable \"syslog\" logging of su activity - in addition to sulog file logging.\n+# SYSLOG_SG_ENAB does the same for newgrp and sg.\n+#\n+SYSLOG_SU_ENAB\t\tyes\n+SYSLOG_SG_ENAB\t\tyes\n+\n+#\n+# If defined, all su activity is logged to this file.\n+#\n+#SULOG_FILE\t/var/log/sulog\n+\n+#\n+# If defined, file which maps tty line to TERM environment parameter.\n+# Each line of the file is in a format something like \"vt100  tty01\".\n+#\n+#TTYTYPE_FILE\t/etc/ttytype\n+\n+#\n+# If defined, login failures will be logged here in a utmp format\n+# last, when invoked as lastb, will read /var/log/btmp, so...\n+#\n+FTMP_FILE\t/var/log/btmp\n+\n+#\n+# If defined, the command name to display when running \"su -\".  For\n+# example, if this is defined as \"su\" then a \"ps\" will display the\n+# command is \"-su\".  If not defined, then \"ps\" would display the\n+# name of the shell actually being run, e.g. something like \"-sh\".\n+#\n+SU_NAME\t\tsu\n+\n+#\n+# If defined, file which inhibits all the usual chatter during the login\n+# sequence.  If a full pathname, then hushed mode will be enabled if the\n+# user's name or shell are found in the file.  If not a full pathname, then\n+# hushed mode will be enabled if the file exists in the user's home directory.\n+#\n+HUSHLOGIN_FILE\t.hushlogin\n+#HUSHLOGIN_FILE\t/etc/hushlogins\n+\n+#\n+# *REQUIRED*  The default PATH settings, for superuser and normal users.\n+#\n+# (they are minimal, add the rest in the shell startup files)\n+ENV_SUPATH\tPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n+ENV_PATH\tPATH=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games\n+\n+#\n+# Terminal permissions\n+#\n+#\tTTYGROUP\tLogin tty will be assigned this group ownership.\n+#\tTTYPERM\t\tLogin tty will be set to this permission.\n+#\n+# If you have a \"write\" program which is \"setgid\" to a special group\n+# which owns the terminals, define TTYGROUP to the group number and\n+# TTYPERM to 0620.  Otherwise leave TTYGROUP commented out and assign\n+# TTYPERM to either 622 or 600.\n+#\n+# In Debian /usr/bin/bsd-write or similar programs are setgid tty\n+# However, the default and recommended value for TTYPERM is still 0600\n+# to not allow anyone to write to anyone else console or terminal\n+\n+# Users can still allow other people to write them by issuing \n+# the \"mesg y\" command.\n+\n+TTYGROUP\ttty\n+TTYPERM\t\t0600\n+\n+#\n+# Login configuration initializations:\n+#\n+#\tERASECHAR\tTerminal ERASE character ('\\010' = backspace).\n+#\tKILLCHAR\tTerminal KILL character ('\\025' = CTRL/U).\n+#\tUMASK\t\tDefault \"umask\" value.\n+#\n+# The ERASECHAR and KILLCHAR are used only on System V machines.\n+# \n+# UMASK is the default umask value for pam_umask and is used by\n+# useradd and newusers to set the mode of the new home directories.\n+# 022 is the \"historical\" value in Debian for UMASK\n+# 027, or even 077, could be considered better for privacy\n+# There is no One True Answer here : each sysadmin must make up his/her\n+# mind.\n+#\n+# If USERGROUPS_ENAB is set to \"yes\", that will modify this UMASK default value\n+# for private user groups, i. e. the uid is the same as gid, and username is\n+# the same as the primary group name: for these, the user permissions will be\n+# used as group permissions, e. g. 022 will become 002.\n+#\n+# Prefix these values with \"0\" to get octal, \"0x\" to get hexadecimal.\n+#\n+ERASECHAR\t0177\n+KILLCHAR\t025\n+UMASK\t\t022\n+\n+#\n+# Password aging controls:\n+#\n+#\tPASS_MAX_DAYS\tMaximum number of days a password may be used.\n+#\tPASS_MIN_DAYS\tMinimum number of days allowed between password changes.\n+#\tPASS_WARN_AGE\tNumber of days warning given before a password expires.\n+#\n+PASS_MAX_DAYS\t99999\n+PASS_MIN_DAYS\t0\n+PASS_WARN_AGE\t7\n+\n+#\n+# Min/max values for automatic uid selection in useradd\n+#\n+UID_MIN\t\t\t 1000\n+UID_MAX\t\t\t60000\n+# System accounts\n+#SYS_UID_MIN\t\t  100\n+#SYS_UID_MAX\t\t  999\n+\n+#\n+# Min/max values for automatic gid selection in groupadd\n+#\n+GID_MIN\t\t\t 1000\n+GID_MAX\t\t\t60000\n+# System accounts\n+#SYS_GID_MIN\t\t  100\n+#SYS_GID_MAX\t\t  999\n+\n+#\n+# Max number of login retries if password is bad. This will most likely be\n+# overriden by PAM, since the default pam_unix module has it's own built\n+# in of 3 retries. However, this is a safe fallback in case you are using\n+# an authentication module that does not enforce PAM_MAXTRIES.\n+#\n+LOGIN_RETRIES\t\t5\n+\n+#\n+# Max time in seconds for login\n+#\n+LOGIN_TIMEOUT\t\t60\n+\n+#\n+# Which fields may be changed by regular users using chfn - use\n+# any combination of letters \"frwh\" (full name, room number, work\n+# phone, home phone).  If not defined, no changes are allowed.\n+# For backward compatibility, \"yes\" = \"rwh\" and \"no\" = \"frwh\".\n+# \n+CHFN_RESTRICT\t\trwh\n+\n+#\n+# Should login be allowed if we can't cd to the home directory?\n+# Default in no.\n+#\n+DEFAULT_HOME\tyes\n+\n+#\n+# If defined, this command is run when removing a user.\n+# It should remove any at/cron/print jobs etc. owned by\n+# the user to be removed (passed as the first argument).\n+#\n+#USERDEL_CMD\t/usr/sbin/userdel_local\n+\n+#\n+# Enable setting of the umask group bits to be the same as owner bits\n+# (examples: 022 -> 002, 077 -> 007) for non-root users, if the uid is\n+# the same as gid, and username is the same as the primary group name.\n+#\n+# If set to yes, userdel will remove the user's group if it contains no\n+# more members, and useradd will create by default a group with the name\n+# of the user.\n+#\n+USERGROUPS_ENAB yes\n+\n+#\n+# Instead of the real user shell, the program specified by this parameter\n+# will be launched, although its visible name (argv[0]) will be the shell's.\n+# The program may do whatever it wants (logging, additional authentification,\n+# banner, ...) before running the actual shell.\n+#\n+# FAKE_SHELL /bin/fakeshell\n+\n+#\n+# If defined, either full pathname of a file containing device names or\n+# a \":\" delimited list of device names.  Root logins will be allowed only\n+# upon these devices.\n+#\n+# This variable is used by login and su.\n+#\n+#CONSOLE\t/etc/consoles\n+#CONSOLE\tconsole:tty01:tty02:tty03:tty04\n+\n+#\n+# List of groups to add to the user's supplementary group set\n+# when logging in on the console (as determined by the CONSOLE\n+# setting).  Default is none.\n+#\n+# Use with caution - it is possible for users to gain permanent\n+# access to these groups, even when not logged in on the console.\n+# How to do it is left as an exercise for the reader...\n+#\n+# This variable is used by login and su.\n+#\n+#CONSOLE_GROUPS\t\tfloppy:audio:cdrom\n+\n+#\n+# If set to \"yes\", new passwords will be encrypted using the MD5-based\n+# algorithm compatible with the one used by recent releases of FreeBSD.\n+# It supports passwords of unlimited length and longer salt strings.\n+# Set to \"no\" if you need to copy encrypted passwords to other systems\n+# which don't understand the new algorithm.  Default is \"no\".\n+#\n+# This variable is deprecated. You should use ENCRYPT_METHOD.\n+#\n+#MD5_CRYPT_ENAB\tno\n+\n+#\n+# If set to MD5 , MD5-based algorithm will be used for encrypting password\n+# If set to SHA256, SHA256-based algorithm will be used for encrypting password\n+# If set to SHA512, SHA512-based algorithm will be used for encrypting password\n+# If set to DES, DES-based algorithm will be used for encrypting password (default)\n+# Overrides the MD5_CRYPT_ENAB option\n+#\n+# Note: It is recommended to use a value consistent with\n+# the PAM modules configuration.\n+#\n+ENCRYPT_METHOD SHA512\n+\n+#\n+# Only used if ENCRYPT_METHOD is set to SHA256 or SHA512.\n+#\n+# Define the number of SHA rounds.\n+# With a lot of rounds, it is more difficult to brute forcing the password.\n+# But note also that it more CPU resources will be needed to authenticate\n+# users.\n+#\n+# If not specified, the libc will choose the default number of rounds (5000).\n+# The values must be inside the 1000-999999999 range.\n+# If only one of the MIN or MAX values is set, then this value will be used.\n+# If MIN > MAX, the highest value will be used.\n+#\n+# SHA_CRYPT_MIN_ROUNDS 5000\n+# SHA_CRYPT_MAX_ROUNDS 5000\n+\n+################# OBSOLETED BY PAM ##############\n+#\t\t\t\t\t\t#\n+# These options are now handled by PAM. Please\t#\n+# edit the appropriate file in /etc/pam.d/ to\t#\n+# enable the equivelants of them.\n+#\n+###############\n+\n+#MOTD_FILE\n+#DIALUPS_CHECK_ENAB\n+#LASTLOG_ENAB\n+#MAIL_CHECK_ENAB\n+#OBSCURE_CHECKS_ENAB\n+#PORTTIME_CHECKS_ENAB\n+#SU_WHEEL_ONLY\n+#CRACKLIB_DICTPATH\n+#PASS_CHANGE_TRIES\n+#PASS_ALWAYS_WARN\n+#ENVIRON_FILE\n+#NOLOGINS_FILE\n+#ISSUE_FILE\n+#PASS_MIN_LEN\n+#PASS_MAX_LEN\n+#ULIMIT\n+#ENV_HZ\n+#CHFN_AUTH\n+#CHSH_AUTH\n+#FAIL_DELAY\n+\n+################# OBSOLETED #######################\n+#\t\t\t\t\t\t  #\n+# These options are no more handled by shadow.    #\n+#                                                 #\n+# Shadow utilities will display a warning if they #\n+# still appear.                                   #\n+#                                                 #\n+###################################################\n+\n+# CLOSE_SESSIONS\n+# LOGIN_STRING\n+# NO_PASSWORD_CONSOLE\n+# QMAIL_DIR\n","exception":"RSpec::Core::MultipleExceptionError","resource_class":"file","resource_params":"[\"/etc/login.defs\"]","resource_id":"/etc/login.defs"}]},{"id":"suid-sgid-check","title":"SUID/SGID Binaries and Critical File Permissions Check","desc":"Check for potentially dangerous SUID/SGID binaries and verify critical file permissions","descriptions":[{"label":"default","data":"Check for potentially dangerous SUID/SGID binaries and verify critical file permissions"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'suid-sgid-check' do\n  impact 1.0\n  title 'SUID/SGID Binaries and Critical File Permissions Check'\n  desc 'Check for potentially dangerous SUID/SGID binaries and verify critical file permissions'\n\n  # Modified permissions for system files based on common configurations\n  critical_files = {\n    '/etc/passwd' => '0644',    # World-readable is standard\n    '/etc/shadow' => '0640',\n    '/etc/group' => '0644',     # World-readable is standard\n    '/etc/gshadow' => '0640',\n    '/etc/ssh/sshd_config' => '0600',\n    '/etc/sudoers' => '0440'\n  }\n\n  critical_files.each do |file, expected_mode|\n    describe file(file) do\n      it { should exist }\n      it { should_not be_writable.by('others') }\n      its('mode') { should cmp expected_mode }\n    end\n  end\n\n  # SUID binary checks\n  safe_suid_binaries = [\n    '/usr/bin/passwd',\n    '/usr/bin/sudo',\n    '/usr/bin/su'\n  ]\n\n  safe_suid_binaries.each do |binary|\n    describe file(binary) do\n      it { should exist }\n      it { should be_setuid }\n      it { should be_executable }\n    end\n  end\n\n  # Check for recently added SUID binaries\n  describe command('find / -type f \\( -perm -4000 -o -perm -2000 \\) -mtime -1 2>/dev/null') do\n    its('stdout') { should be_empty }\n  end\n\n  # World-writable directories that should have sticky bit\n  world_writable_dirs = [\n    '/tmp',\n    '/var/tmp',\n    '/dev/shm'\n  ]\n\n  world_writable_dirs.each do |dir|\n    describe file(dir) do\n      it { should exist }\n      it { should be_directory }\n      it { should be_sticky }\n    end\n  end\n\n  # Custom check for workspace directories\n  workspace_dirs = [\n    '/workspaces',\n    '/workspaces/.oryx',\n    '/workspaces/.codespaces'\n  ]\n\n  workspace_dirs.each do |dir|\n    describe file(dir) do\n      it { should exist }\n      it { should be_directory }\n      # Not checking sticky bit for workspace dirs as they may have different requirements\n    end\n  end\nend","source_location":{"line":124,"ref":"linux-security-checks/controls/linux_checks.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /etc/passwd is expected to exist","run_time":9.8624e-05,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/etc/passwd\"]","resource_id":"/etc/passwd"},{"status":"passed","code_desc":"File /etc/passwd is expected not to be writable by others","run_time":0.018492099,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/etc/passwd\"]","resource_id":"/etc/passwd"},{"status":"passed","code_desc":"File /etc/passwd mode is expected to cmp == \"0644\"","run_time":0.000341196,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/etc/passwd\"]","resource_id":"/etc/passwd"},{"status":"passed","code_desc":"File /etc/shadow is expected to exist","run_time":0.000120194,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/etc/shadow\"]","resource_id":"/etc/shadow"},{"status":"passed","code_desc":"File /etc/shadow is expected not to be writable by others","run_time":0.017310117,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/etc/shadow\"]","resource_id":"/etc/shadow"},{"status":"passed","code_desc":"File /etc/shadow mode is expected to cmp == \"0640\"","run_time":0.000373016,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/etc/shadow\"]","resource_id":"/etc/shadow"},{"status":"passed","code_desc":"File /etc/group is expected to exist","run_time":0.000112329,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/etc/group\"]","resource_id":"/etc/group"},{"status":"passed","code_desc":"File /etc/group is expected not to be writable by others","run_time":0.01724323,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/etc/group\"]","resource_id":"/etc/group"},{"status":"passed","code_desc":"File /etc/group mode is expected to cmp == \"0644\"","run_time":0.000342269,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/etc/group\"]","resource_id":"/etc/group"},{"status":"passed","code_desc":"File /etc/gshadow is expected to exist","run_time":0.000173924,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/etc/gshadow\"]","resource_id":"/etc/gshadow"},{"status":"passed","code_desc":"File /etc/gshadow is expected not to be writable by others","run_time":0.017282821,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/etc/gshadow\"]","resource_id":"/etc/gshadow"},{"status":"passed","code_desc":"File /etc/gshadow mode is expected to cmp == \"0640\"","run_time":0.000359891,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/etc/gshadow\"]","resource_id":"/etc/gshadow"},{"status":"passed","code_desc":"File /etc/ssh/sshd_config is expected to exist","run_time":0.000157573,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/etc/ssh/sshd_config\"]","resource_id":"/etc/ssh/sshd_config"},{"status":"passed","code_desc":"File /etc/ssh/sshd_config is expected not to be writable by others","run_time":0.017079374,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/etc/ssh/sshd_config\"]","resource_id":"/etc/ssh/sshd_config"},{"status":"failed","code_desc":"File /etc/ssh/sshd_config mode is expected to cmp == \"0600\"","run_time":0.000319075,"start_time":"2024-12-05T16:37:50+00:00","message":"\nexpected: 0600\n     got: 0644\n\n(compared using `cmp` matcher)\n","resource_class":"file","resource_params":"[\"/etc/ssh/sshd_config\"]","resource_id":"/etc/ssh/sshd_config"},{"status":"passed","code_desc":"File /etc/sudoers is expected to exist","run_time":9.9415e-05,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/etc/sudoers\"]","resource_id":"/etc/sudoers"},{"status":"passed","code_desc":"File /etc/sudoers is expected not to be writable by others","run_time":0.017177521,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/etc/sudoers\"]","resource_id":"/etc/sudoers"},{"status":"passed","code_desc":"File /etc/sudoers mode is expected to cmp == \"0440\"","run_time":0.000343691,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/etc/sudoers\"]","resource_id":"/etc/sudoers"},{"status":"passed","code_desc":"File /usr/bin/passwd is expected to exist","run_time":0.00019279,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/usr/bin/passwd\"]","resource_id":"/usr/bin/passwd"},{"status":"passed","code_desc":"File /usr/bin/passwd is expected to be setuid","run_time":0.02784218,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/usr/bin/passwd\"]","resource_id":"/usr/bin/passwd"},{"status":"passed","code_desc":"File /usr/bin/passwd is expected to be executable","run_time":0.000268912,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/usr/bin/passwd\"]","resource_id":"/usr/bin/passwd"},{"status":"passed","code_desc":"File /usr/bin/sudo is expected to exist","run_time":0.000134401,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/usr/bin/sudo\"]","resource_id":"/usr/bin/sudo"},{"status":"passed","code_desc":"File /usr/bin/sudo is expected to be setuid","run_time":0.020498229,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/usr/bin/sudo\"]","resource_id":"/usr/bin/sudo"},{"status":"passed","code_desc":"File /usr/bin/sudo is expected to be executable","run_time":0.00030584,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/usr/bin/sudo\"]","resource_id":"/usr/bin/sudo"},{"status":"passed","code_desc":"File /usr/bin/su is expected to exist","run_time":0.000222464,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/usr/bin/su\"]","resource_id":"/usr/bin/su"},{"status":"passed","code_desc":"File /usr/bin/su is expected to be setuid","run_time":0.020608087,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/usr/bin/su\"]","resource_id":"/usr/bin/su"},{"status":"passed","code_desc":"File /usr/bin/su is expected to be executable","run_time":0.000312021,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"file","resource_params":"[\"/usr/bin/su\"]","resource_id":"/usr/bin/su"},{"status":"passed","code_desc":"Command: `find / -type f \\( -perm -4000 -o -perm -2000 \\) -mtime -1 2>/dev/null` stdout is expected to be empty","run_time":15.28121216,"start_time":"2024-12-05T16:37:50+00:00","resource_class":"command","resource_params":"[\"find / -type f \\\\( -perm -4000 -o -perm -2000 \\\\) -mtime -1 2>/dev/null\"]","resource_id":"Command: `find / -type f \\( -perm -4000 -o -perm -2000 \\) -mtime -1 2>/dev/null`"},{"status":"passed","code_desc":"File /tmp is expected to exist","run_time":0.000202418,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/tmp\"]","resource_id":"/tmp"},{"status":"passed","code_desc":"File /tmp is expected to be directory","run_time":0.014350967,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/tmp\"]","resource_id":"/tmp"},{"status":"passed","code_desc":"File /tmp is expected to be sticky","run_time":0.02965511,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/tmp\"]","resource_id":"/tmp"},{"status":"passed","code_desc":"File /var/tmp is expected to exist","run_time":0.00021483,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/var/tmp\"]","resource_id":"/var/tmp"},{"status":"passed","code_desc":"File /var/tmp is expected to be directory","run_time":0.003448279,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/var/tmp\"]","resource_id":"/var/tmp"},{"status":"passed","code_desc":"File /var/tmp is expected to be sticky","run_time":0.020991008,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/var/tmp\"]","resource_id":"/var/tmp"},{"status":"passed","code_desc":"File /dev/shm is expected to exist","run_time":0.000242022,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/dev/shm\"]","resource_id":"/dev/shm"},{"status":"passed","code_desc":"File /dev/shm is expected to be directory","run_time":0.003396492,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/dev/shm\"]","resource_id":"/dev/shm"},{"status":"passed","code_desc":"File /dev/shm is expected to be sticky","run_time":0.020594171,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/dev/shm\"]","resource_id":"/dev/shm"},{"status":"passed","code_desc":"File /workspaces is expected to exist","run_time":0.000192849,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/workspaces\"]","resource_id":"/workspaces"},{"status":"passed","code_desc":"File /workspaces is expected to be directory","run_time":0.00345917,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/workspaces\"]","resource_id":"/workspaces"},{"status":"passed","code_desc":"File /workspaces/.oryx is expected to exist","run_time":0.000108312,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/workspaces/.oryx\"]","resource_id":"/workspaces/.oryx"},{"status":"passed","code_desc":"File /workspaces/.oryx is expected to be directory","run_time":0.004217173,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/workspaces/.oryx\"]","resource_id":"/workspaces/.oryx"},{"status":"passed","code_desc":"File /workspaces/.codespaces is expected to exist","run_time":9.0138e-05,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/workspaces/.codespaces\"]","resource_id":"/workspaces/.codespaces"},{"status":"passed","code_desc":"File /workspaces/.codespaces is expected to be directory","run_time":0.003284484,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/workspaces/.codespaces\"]","resource_id":"/workspaces/.codespaces"}]},{"id":"rootkit-access-check","title":"Rootkit Detection and System Access Control Verification","desc":"Comprehensive check for rootkits and system access control verification including file integrity, processes, and network connections","descriptions":[{"label":"default","data":"Comprehensive check for rootkits and system access control verification including file integrity, processes, and network connections"}],"impact":1.0,"refs":[],"tags":{"security":null,"rootkit":null,"system-access":null},"code":"control 'rootkit-access-check' do\n  impact 1.0\n  title 'Rootkit Detection and System Access Control Verification'\n  desc 'Comprehensive check for rootkits and system access control verification including file integrity, processes, and network connections'\n  \n  tag 'security'\n  tag 'rootkit'\n  tag 'system-access'\n\n  # 1. Check Chkrootkit Installation\n  describe package('chkrootkit') do\n    it { should be_installed }\n  end\n\n  # 2. Run Chkrootkit Scan\n  describe command('chkrootkit') do\n    its('exit_status') { should eq 0 }\n    its('stdout') { should_not match(/INFECTED/) }\n    its('stdout') { should_not match(/warning/i) }\n    its('stderr') { should_not match(/error|fail/i) }\n  end\n\n  # 3. Check File Integrity\n  describe command('find /bin /sbin /usr/bin /usr/sbin -type f -mtime -1') do\n    its('stdout') { should be_empty }\n  end\n\n  # 4. Check Critical System Files for Modifications\n  %w(/bin/login /bin/ls /bin/ps /bin/netstat /sbin/ifconfig).each do |file|\n    describe file(file) do\n      it { should exist }\n      it { should_not be_writable.by('group') }\n      it { should_not be_writable.by('others') }\n      its('mode') { should cmp '0755' }\n    end\n  end\n\n  # 5. Check for Hidden Processes\n  describe command('ps auxf | grep -v grep | grep \"^[[:space:]]*\\[\"') do\n    its('stdout') { should be_empty }\n  end\n\n  # 6. Check for Suspicious Network Connections\n  describe command('netstat -tulpn | grep LISTEN') do\n    its('exit_status') { should eq 0 }\n    its('stdout') { should_not match(/0\\.0\\.0\\.0:.*LISTEN/) }\n  end\n\n  # 7. Check for Suspicious Loaded Kernel Modules\n  describe command('lsmod') do\n    its('stdout') { should_not match(/hide_proc|hp_mod|kisni|mood/) }\n  end\n\n  # 8. Check System Access Controls\n  describe file('/etc/security/access.conf') do\n    it { should exist }\n    it { should be_file }\n    it { should_not be_readable.by('others') }\n    its('mode') { should cmp '0644' }\n  end\n\n  # 9. Check SELinux/AppArmor Status\n  describe.one do\n    describe command('sestatus') do\n      its('stdout') { should match(/enabled|enforcing/) }\n    end\n    \n    describe command('apparmor_status') do\n      its('stdout') { should match(/profiles are loaded/) }\n    end\n  end\n\n  # 10. Check for Unauthorized SUID/SGID Files\n  describe command('find / -type f \\( -perm -4000 -o -perm -2000 \\) -not -path \"/proc/*\" 2>/dev/null') do\n    its('stdout') { should_not match(%r{\n      (?!(/usr/bin/sudo|/usr/bin/su|/usr/bin/passwd|/usr/bin/chage|/usr/bin/gpasswd|/usr/bin/newgrp))\n      (/[^\\s]+)\n    }x) }\n  end\nend","source_location":{"line":14,"ref":"linux-security-checks/controls/rootkit_access_check.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"System Package chkrootkit is expected to be installed","run_time":0.055658436,"start_time":"2024-12-05T16:38:06+00:00","message":"expected that `System Package chkrootkit` is installed","resource_class":"package","resource_params":"[\"chkrootkit\"]","resource_id":"chkrootkit"},{"status":"failed","code_desc":"Command: `chkrootkit` exit_status is expected to eq 0","run_time":0.0074282,"start_time":"2024-12-05T16:38:06+00:00","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n","resource_class":"command","resource_params":"[\"chkrootkit\"]","resource_id":"Command: `chkrootkit`"},{"status":"passed","code_desc":"Command: `chkrootkit` stdout is expected not to match /INFECTED/","run_time":0.000207808,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"command","resource_params":"[\"chkrootkit\"]","resource_id":"Command: `chkrootkit`"},{"status":"passed","code_desc":"Command: `chkrootkit` stdout is expected not to match /warning/i","run_time":0.00011279,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"command","resource_params":"[\"chkrootkit\"]","resource_id":"Command: `chkrootkit`"},{"status":"passed","code_desc":"Command: `chkrootkit` stderr is expected not to match /error|fail/i","run_time":0.000117849,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"command","resource_params":"[\"chkrootkit\"]","resource_id":"Command: `chkrootkit`"},{"status":"passed","code_desc":"Command: `find /bin /sbin /usr/bin /usr/sbin -type f -mtime -1` stdout is expected to be empty","run_time":0.03410158,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"command","resource_params":"[\"find /bin /sbin /usr/bin /usr/sbin -type f -mtime -1\"]","resource_id":"Command: `find /bin /sbin /usr/bin /usr/sbin -type f -mtime -1`"},{"status":"passed","code_desc":"File /bin/login is expected to exist","run_time":0.000192229,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/bin/login\"]","resource_id":"/bin/login"},{"status":"passed","code_desc":"File /bin/login is expected not to be writable by group","run_time":0.017335595,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/bin/login\"]","resource_id":"/bin/login"},{"status":"passed","code_desc":"File /bin/login is expected not to be writable by others","run_time":0.000398343,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/bin/login\"]","resource_id":"/bin/login"},{"status":"passed","code_desc":"File /bin/login mode is expected to cmp == \"0755\"","run_time":0.000398322,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/bin/login\"]","resource_id":"/bin/login"},{"status":"passed","code_desc":"File /bin/ls is expected to exist","run_time":0.000178423,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/bin/ls\"]","resource_id":"/bin/ls"},{"status":"passed","code_desc":"File /bin/ls is expected not to be writable by group","run_time":0.020655961,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/bin/ls\"]","resource_id":"/bin/ls"},{"status":"passed","code_desc":"File /bin/ls is expected not to be writable by others","run_time":0.000662014,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/bin/ls\"]","resource_id":"/bin/ls"},{"status":"passed","code_desc":"File /bin/ls mode is expected to cmp == \"0755\"","run_time":0.001371357,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/bin/ls\"]","resource_id":"/bin/ls"},{"status":"passed","code_desc":"File /bin/ps is expected to exist","run_time":0.000175146,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/bin/ps\"]","resource_id":"/bin/ps"},{"status":"passed","code_desc":"File /bin/ps is expected not to be writable by group","run_time":0.022328852,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/bin/ps\"]","resource_id":"/bin/ps"},{"status":"passed","code_desc":"File /bin/ps is expected not to be writable by others","run_time":0.000483071,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/bin/ps\"]","resource_id":"/bin/ps"},{"status":"passed","code_desc":"File /bin/ps mode is expected to cmp == \"0755\"","run_time":0.000462974,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/bin/ps\"]","resource_id":"/bin/ps"},{"status":"passed","code_desc":"File /bin/netstat is expected to exist","run_time":0.00018748,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/bin/netstat\"]","resource_id":"/bin/netstat"},{"status":"passed","code_desc":"File /bin/netstat is expected not to be writable by group","run_time":0.019276885,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/bin/netstat\"]","resource_id":"/bin/netstat"},{"status":"passed","code_desc":"File /bin/netstat is expected not to be writable by others","run_time":0.000306963,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/bin/netstat\"]","resource_id":"/bin/netstat"},{"status":"passed","code_desc":"File /bin/netstat mode is expected to cmp == \"0755\"","run_time":0.000368166,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/bin/netstat\"]","resource_id":"/bin/netstat"},{"status":"passed","code_desc":"File /sbin/ifconfig is expected to exist","run_time":0.000109233,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/sbin/ifconfig\"]","resource_id":"/sbin/ifconfig"},{"status":"passed","code_desc":"File /sbin/ifconfig is expected not to be writable by group","run_time":0.017214955,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/sbin/ifconfig\"]","resource_id":"/sbin/ifconfig"},{"status":"passed","code_desc":"File /sbin/ifconfig is expected not to be writable by others","run_time":0.000246539,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/sbin/ifconfig\"]","resource_id":"/sbin/ifconfig"},{"status":"passed","code_desc":"File /sbin/ifconfig mode is expected to cmp == \"0755\"","run_time":0.000297355,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/sbin/ifconfig\"]","resource_id":"/sbin/ifconfig"},{"status":"passed","code_desc":"Command: `ps auxf | grep -v grep | grep \"^[[:space:]]*\\[\"` stdout is expected to be empty","run_time":0.024573667,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"command","resource_params":"[\"ps auxf | grep -v grep | grep \\\"^[[:space:]]*\\\\[\\\"\"]","resource_id":"Command: `ps auxf | grep -v grep | grep \"^[[:space:]]*\\[\"`"},{"status":"passed","code_desc":"Command: `netstat -tulpn | grep LISTEN` exit_status is expected to eq 0","run_time":0.022666072,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"command","resource_params":"[\"netstat -tulpn | grep LISTEN\"]","resource_id":"Command: `netstat -tulpn | grep LISTEN`"},{"status":"failed","code_desc":"Command: `netstat -tulpn | grep LISTEN` stdout is expected not to match /0\\.0\\.0\\.0:.*LISTEN/","run_time":0.001594073,"start_time":"2024-12-05T16:38:06+00:00","message":"expected \"tcp        0      0 127.0.0.1:16634         0.0.0.0:*               LISTEN      -                   ...6       0      0 :::2000                 :::*                    LISTEN      -                   \\n\" not to match /0\\.0\\.0\\.0:.*LISTEN/\nDiff:\n@@ -1,11 +1,21 @@\n-/0\\.0\\.0\\.0:.*LISTEN/\n+tcp        0      0 127.0.0.1:16634         0.0.0.0:*               LISTEN      -                   \n+tcp        0      0 127.0.0.1:16635         0.0.0.0:*               LISTEN      -                   \n+tcp        0      0 127.0.0.1:37513         0.0.0.0:*               LISTEN      820/node            \n+tcp        0      0 0.0.0.0:2222            0.0.0.0:*               LISTEN      -                   \n+tcp        0      0 0.0.0.0:2000            0.0.0.0:*               LISTEN      -                   \n+tcp        0      0 127.0.0.1:44699         0.0.0.0:*               LISTEN      -                   \n+tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   \n+tcp6       0      0 ::1:16634               :::*                    LISTEN      -                   \n+tcp6       0      0 ::1:16635               :::*                    LISTEN      -                   \n+tcp6       0      0 :::2222                 :::*                    LISTEN      -                   \n+tcp6       0      0 :::2000                 :::*                    LISTEN      -                   \n","resource_class":"command","resource_params":"[\"netstat -tulpn | grep LISTEN\"]","resource_id":"Command: `netstat -tulpn | grep LISTEN`"},{"status":"passed","code_desc":"Command: `lsmod` stdout is expected not to match /hide_proc|hp_mod|kisni|mood/","run_time":0.00609832,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"command","resource_params":"[\"lsmod\"]","resource_id":"Command: `lsmod`"},{"status":"passed","code_desc":"File /etc/security/access.conf is expected to exist","run_time":0.000168704,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/etc/security/access.conf\"]","resource_id":"/etc/security/access.conf"},{"status":"passed","code_desc":"File /etc/security/access.conf is expected to be file","run_time":0.003614132,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/etc/security/access.conf\"]","resource_id":"/etc/security/access.conf"},{"status":"failed","code_desc":"File /etc/security/access.conf is expected not to be readable by others","run_time":0.017422131,"start_time":"2024-12-05T16:38:06+00:00","message":"expected File /etc/security/access.conf not to be readable by others","resource_class":"file","resource_params":"[\"/etc/security/access.conf\"]","resource_id":"/etc/security/access.conf"},{"status":"passed","code_desc":"File /etc/security/access.conf mode is expected to cmp == \"0644\"","run_time":0.000369599,"start_time":"2024-12-05T16:38:06+00:00","resource_class":"file","resource_params":"[\"/etc/security/access.conf\"]","resource_id":"/etc/security/access.conf"},{"status":"failed","code_desc":"Command: `sestatus` stdout is expected to match /enabled|enforcing/","run_time":0.001404611,"start_time":"2024-12-05T16:38:06+00:00","message":"expected \"\" to match /enabled|enforcing/\nDiff:\n@@ -1 +1 @@\n-/enabled|enforcing/\n+\"\"\n","exception":"RSpec::Core::MultipleExceptionError","resource_class":"command","resource_params":"[\"sestatus\"]","resource_id":"Command: `sestatus`"},{"status":"failed","code_desc":"Command: `apparmor_status` stdout is expected to match /profiles are loaded/","run_time":0.000408912,"start_time":"2024-12-05T16:38:06+00:00","message":"expected \"\" to match /profiles are loaded/\nDiff:\n@@ -1 +1 @@\n-/profiles are loaded/\n+\"\"\n","exception":"RSpec::Core::MultipleExceptionError","resource_class":"command","resource_params":"[\"apparmor_status\"]","resource_id":"Command: `apparmor_status`"},{"status":"failed","code_desc":"Command: `find / -type f \\( -perm -4000 -o -perm -2000 \\) -not -path \"/proc/*\" 2>/dev/null` stdout is expected not to match /\n      (?!(\\/usr\\/bin\\/sudo|\\/usr\\/bin\\/su|\\/usr\\/bin\\/passwd|\\/usr\\/bin\\/chage|\\/usr\\/bin\\/gpasswd|\\/usr\\/bin\\/newgrp))\n      (\\/[^\\s]+)\n    /x","run_time":3.870828365,"start_time":"2024-12-05T16:38:06+00:00","message":"expected \"/usr/sbin/unix_chkpwd\\n/usr/sbin/pam_extrausers_chkpwd\\n/usr/lib/openssh/ssh-keysign\\n/usr/lib/dbus-...in/chsh\\n/usr/bin/gpasswd\\n/usr/bin/sudo\\n/usr/bin/ssh-agent\\n/usr/bin/bsd-write\\n/usr/bin/pkexec\\n\" not to match /\n      (?!(\\/usr\\/bin\\/sudo|\\/usr\\/bin\\/su|\\/usr\\/bin\\/passwd|\\/usr\\/bin\\/chage|\\/usr\\/bin\\/gpasswd|\\/usr\\/bin\\/newgrp))\n      (\\/[^\\s]+)\n    /x\nDiff:\n@@ -1,5 +1,20 @@\n-/\n-      (?!(\\/usr\\/bin\\/sudo|\\/usr\\/bin\\/su|\\/usr\\/bin\\/passwd|\\/usr\\/bin\\/chage|\\/usr\\/bin\\/gpasswd|\\/usr\\/bin\\/newgrp))\n-      (\\/[^\\s]+)\n-    /x\n+/usr/sbin/unix_chkpwd\n+/usr/sbin/pam_extrausers_chkpwd\n+/usr/lib/openssh/ssh-keysign\n+/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n+/usr/lib/policykit-1/polkit-agent-helper-1\n+/usr/bin/passwd\n+/usr/bin/chage\n+/usr/bin/mount\n+/usr/bin/chfn\n+/usr/bin/su\n+/usr/bin/expiry\n+/usr/bin/umount\n+/usr/bin/newgrp\n+/usr/bin/chsh\n+/usr/bin/gpasswd\n+/usr/bin/sudo\n+/usr/bin/ssh-agent\n+/usr/bin/bsd-write\n+/usr/bin/pkexec\n","resource_class":"command","resource_params":"[\"find / -type f \\\\( -perm -4000 -o -perm -2000 \\\\) -not -path \\\"/proc/*\\\" 2>/dev/null\"]","resource_id":"Command: `find / -type f \\( -perm -4000 -o -perm -2000 \\) -not -path \"/proc/*\" 2>/dev/null`"}]}],"status":"loaded","status_message":""}],"statistics":{"duration":19.84342521},"version":"5.22.58"}